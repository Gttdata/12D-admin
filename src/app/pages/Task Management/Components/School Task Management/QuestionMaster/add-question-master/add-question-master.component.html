<div>
  <form nz-form #Student="ngForm">
    <nz-spin [nzSpinning]="isSpinning">
      <div nz-row>
        <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="11">
          <div nz-row class="my-box">
            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="12">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon>Class Name </nz-form-label>
                <nz-form-control nzErrorTip="Please Select Class ">
                  <nz-input-group nzCompact>
                    <nz-select
                      name="className"
                      nzPlaceHolder="Select Class Name"
                      [(ngModel)]="data.CLASS_ID"
                      style="width: 100%"
                      nzAllowClear
                      nzShowSearch
                      required
                      [nzLoading]="classLoad"
                      (ngModelChange)="selectSubject($event)"
                    >
                      <nz-option
                        *ngFor="let class of QuePaperClassList"
                        [nzValue]="class.ID"
                        [nzLabel]="class.NAME"
                      >
                      </nz-option>
                    </nz-select>
                  </nz-input-group>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="12">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon
                  >Subject Name
                </nz-form-label>
                <nz-form-control nzErrorTip="Please Select Subject ">
                  <nz-input-group nzCompact>
                    <nz-select
                      name="subjectName"
                      nzPlaceHolder="Select Subject Name"
                      [(ngModel)]="data.SUBJECT_ID"
                      style="width: 100%"
                      nzAllowClear
                      nzShowSearch
                      required
                      [nzLoading]="subjectLoad"
                      (ngModelChange)="selectChapter($event)"
                    >
                      <nz-option
                        *ngFor="let sub of QuePaperSubjectList"
                        [nzValue]="sub.ID"
                        [nzLabel]="sub.NAME"
                      >
                      </nz-option>
                    </nz-select>
                  </nz-input-group>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="12">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon
                  >Chapter Name
                </nz-form-label>
                <nz-form-control nzErrorTip="Please Select Chapter ">
                  <nz-input-group nzCompact>
                    <nz-select
                      name="chapterName"
                      nzPlaceHolder="Select Chapter Name"
                      [(ngModel)]="data.CHAPTER_ID"
                      style="width: 100%"
                      nzAllowClear
                      nzShowSearch
                      required
                      [nzLoading]="chapterLoad"
                    >
                      <nz-option
                        *ngFor="let chapter of chapterList"
                        [nzValue]="chapter.ID"
                        [nzLabel]="chapter.NAME"
                      >
                      </nz-option>
                    </nz-select>
                  </nz-input-group>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="12">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon
                  >Question Type
                </nz-form-label>
                <nz-form-control nzErrorTip="Please Select Question Type">
                  <nz-input-group nzCompact>
                    <nz-select
                      name="qtype"
                      nzPlaceHolder="Select Question Type"
                      [(ngModel)]="data.QUESTION_TYPE"
                      style="width: 100%"
                      nzShowSearch
                      nzAllowClear
                      required
                      [nzLoading]="typeLoad"
                    >
                      <nz-option
                        *ngFor="let type of questionTypeList"
                        [nzValue]="type.ID"
                        [nzLabel]="type.LABEL"
                      >
                      </nz-option>
                    </nz-select>
                  </nz-input-group>
                </nz-form-control>
              </nz-form-item>
            </div>
            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="17">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon> Question </nz-form-label>
                <nz-form-control
                  nzHasFeedback
                  nzErrorTip=" Please Enter Valid Question"
                >
                  <textarea
                    rows="3"
                    nz-input
                    autocomplete="off"
                    name="questions"
                    placeholder="Enter Question"
                    maxlength="256"
                    required
                    [(ngModel)]="data.QUESTION"
                  ></textarea>
                  <h6 style="color: red; font-size: 10px" *ngIf="data.QUESTION">
                    {{ data.QUESTION.length }}/256
                  </h6>
                  <h6
                    style="color: red; font-size: 10px"
                    *ngIf="!data.QUESTION"
                  >
                    0/256
                  </h6>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="7">
              <nz-form-item>
                <nz-form-label nzNoColon>Question Image</nz-form-label>
                <div style="text-align: left">
                  <div
                    *ngIf="
                      data.QUESTION_IMAGE == null ||
                      data.QUESTION_IMAGE == undefined ||
                      data.QUESTION_IMAGE == ''
                    "
                    style="color: blue"
                  >
                    <button
                      nz-button
                      style="
                        height: 28px;
                        padding: 0px 7px;
                        font-size: 12px;
                        width: 90%;
                      "
                      (click)="fileInput.click()"
                    >
                      <span nz-icon nzType="upload" nzTheme="outline"></span>
                      <input
                        #fileInput
                        name="queImage"
                        accept=".jpg, .jpeg, .png"
                        (change)="onFileSelectedQuestion($event)"
                        type="file"
                        style="display: none"
                      />
                    </button>
                  </div>

                  <span
                    *ngIf="
                      data.QUESTION_IMAGE != null &&
                      data.QUESTION_IMAGE != undefined &&
                      data.QUESTION_IMAGE != ''
                    "
                    style="justify-content: center; display: flex"
                  >
                    <img
                      class="img"
                      nz-image
                      style="border-radius: 5px"
                      width="40%"
                      height="30%"
                      [nzSrc]="questionImageUrl"
                      alt="No Image Found"
                    />
                  </span>

                  <span
                    *ngIf="
                      data.QUESTION_IMAGE !== null &&
                      data.QUESTION_IMAGE !== undefined &&
                      data.QUESTION_IMAGE !== ''
                    "
                  >
                    <div *ngIf="progressBarQuestionImage">
                      <nz-progress
                        [style.width]="percentQuestionImage + '%'"
                        [nzPercent]="percentQuestionImage"
                        >{{ percentQuestionImage }}%</nz-progress
                      >
                    </div>
                    {{ data.QUESTION_IMAGE }}
                  </span>
                  <br />

                  <div
                    *ngIf="
                      data.QUESTION_IMAGE !== null &&
                      data.QUESTION_IMAGE !== undefined &&
                      data.QUESTION_IMAGE !== ''
                    "
                    style="display: flex; justify-content: center"
                  >
                    <!-- <a
                      style="color: blue; margin-right: 9px"
                      (click)="ViewQuestion(data.QUESTION_IMAGE)"
                      nz-tooltip
                      nzTooltipTitle="Click Here To View Uploaded Document"
                    >
                      <span nz-icon nzType="eye" nzTheme="outline"></span>
                    </a> -->

                    <span
                      style="cursor: pointer"
                      nz-popconfirm
                      nzPopconfirmTitle="Are you sure want delete?"
                      (nzOnConfirm)="deleteQuestionConfirm(data.QUESTION_IMAGE)"
                      (nzOnCancel)="deleteCancel()"
                      nzPopconfirmPlacement="top"
                    >
                      <span
                        nz-icon
                        nzType="delete"
                        nzTheme="twotone"
                        nz-tooltip
                        nzTooltipTitle="Delete"
                      >
                      </span>
                    </span>
                  </div>
                </div>
              </nz-form-item>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
              <nz-form-item>
                <nz-form-label nzNoColon>Description</nz-form-label>
                <nz-form-control
                  nzHasFeedback
                  nzErrorTip="Please Enter Description"
                >
                  <textarea
                    rows="2"
                    nz-input
                    placeholder="Enter Description"
                    name="description"
                    maxlength="256"
                    required
                    [(ngModel)]="data.DESCRIPTION"
                  ></textarea>
                  <h6
                    style="color: red; font-size: 10px"
                    *ngIf="data.DESCRIPTION"
                  >
                    {{ data.DESCRIPTION.length }}/256
                  </h6>
                  <h6
                    style="color: red; font-size: 10px"
                    *ngIf="!data.DESCRIPTION"
                  >
                    0/256
                  </h6>
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>

          <div nz-row class="my-box">
            <div nz-col nzSpan="8">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon>Sequence No </nz-form-label>
                <nz-form-control nzHasFeedback nzErrorTip="Enter Sequence No">
                  <input
                    nz-input
                    name="seqno"
                    style="width: 100%"
                    autocomplete="off"
                    [(ngModel)]="data.SEQ_NO"
                    placeholder="Enter Sequence No"
                    (keypress)="commonFunction.omit($event)"
                    maxlength="5"
                    required
                    disabled
                  />
                </nz-form-control>
              </nz-form-item>
            </div>
            <div nz-col nzSpan="6">
              <nz-form-item>
                <nz-form-label nzNoColon> Status </nz-form-label>
                <nz-form-control>
                  <nz-switch
                    name="status"
                    [(ngModel)]="data.STATUS"
                    nzCheckedChildren="Active"
                      nzUnCheckedChildren="InActive"
                  ></nz-switch>
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>
        </div>

        <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="1"></div>

        <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="12">
          <div nz-row class="my-box">
            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon>Answer</nz-form-label>
                <nz-form-control nzHasFeedback nzErrorTip="Please Enter Answer">
                  <textarea
                    rows="3"
                    nz-input
                    placeholder="Enter Answer"
                    name="answer"
                    maxlength="256"
                    required
                    [(ngModel)]="data.ANSWER"
                  ></textarea>
                  <h6 style="color: red; font-size: 10px" *ngIf="data.ANSWER">
                    {{ data.ANSWER.length }}/256
                  </h6>
                  <h6 style="color: red; font-size: 10px" *ngIf="!data.ANSWER">
                    0/256
                  </h6>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nzSpan="8">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon>Marks </nz-form-label>
                <nz-form-control nzHasFeedback nzErrorTip="Enter Marks">
                  <input
                    nz-input
                    name="marks"
                    style="width: 100%"
                    autocomplete="off"
                    [(ngModel)]="data.MARKS"
                    placeholder="Enter Marks"
                    (keypress)="commonFunction.numberWithDecimal($event)"
                    maxlength="5"
                    required
                  />
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="7">
              <nz-form-item>
                <nz-form-label nzNoColon>Answer Image</nz-form-label>
                <div style="text-align: left">
                  <div
                    *ngIf="
                      data.ANSWER_IMAGE == null ||
                      data.ANSWER_IMAGE == undefined ||
                      data.ANSWER_IMAGE == ''
                    "
                    style="color: blue"
                  >
                    <button
                      nz-button
                      style="
                        height: 28px;
                        padding: 0px 7px;
                        font-size: 12px;
                        width: 100%;
                      "
                      (click)="fileInput.click()"
                    >
                      <span nz-icon nzType="upload" nzTheme="outline"></span>
                      <input
                        #fileInput
                        name="answerImage"
                        accept=".jpg, .jpeg, .png"
                        (change)="onFileSelectedAnswer($event)"
                        type="file"
                        style="display: none"
                      />
                    </button>
                  </div>

                  <span
                    *ngIf="
                      data.ANSWER_IMAGE != null &&
                      data.ANSWER_IMAGE != undefined &&
                      data.ANSWER_IMAGE != ''
                    "
                    style="justify-content: center; display: flex"
                  >
                    <img
                      class="img"
                      nz-image
                      style="border-radius: 5px"
                      width="40%"
                      height="30%"
                      [nzSrc]="answerImageUrl"
                      alt="No Image Found"
                    />
                  </span>
                  <span
                    *ngIf="
                      data.ANSWER_IMAGE !== null &&
                      data.ANSWER_IMAGE !== undefined &&
                      data.ANSWER_IMAGE !== ''
                    "
                  >
                    <div *ngIf="progressBarAnswerImage">
                      <nz-progress
                        [style.width]="percentAnswerImage + '%'"
                        [nzPercent]="percentAnswerImage"
                        >{{ percentAnswerImage }}%</nz-progress
                      >
                    </div>
                    {{ data.ANSWER_IMAGE }}
                  </span>
                  <br />

                  <div
                    *ngIf="
                      data.ANSWER_IMAGE !== null &&
                      data.ANSWER_IMAGE !== undefined &&
                      data.ANSWER_IMAGE !== ''
                    "
                    style="display: flex; justify-content: center"
                  >
                    <!-- <a
                      style="color: blue; margin-right: 9px"
                      (click)="ViewAnswer(data.ANSWER_IMAGE)"
                      nz-tooltip
                      nzTooltipTitle="Click Here To View Uploaded Document"
                    >
                      <span nz-icon nzType="eye" nzTheme="outline"></span>
                    </a> -->

                    <span
                      style="cursor: pointer"
                      nz-popconfirm
                      nzPopconfirmTitle="Are you sure want delete?"
                      (nzOnConfirm)="deleteAnswerConfirm(data.ANSWER_IMAGE)"
                      (nzOnCancel)="deleteCancel()"
                      nzPopconfirmPlacement="top"
                    >
                      <span
                        nz-icon
                        nzType="delete"
                        nzTheme="twotone"
                        nz-tooltip
                        nzTooltipTitle="Delete"
                      >
                      </span>
                    </span>
                  </div>
                </div>
              </nz-form-item>
            </div>
          </div>

          <div nz-row class="my-box" *ngIf="data.QUESTION_TYPE == 1">
            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
              <nz-form-item>
                <nz-form-label nzRequired nzNoColon>Option</nz-form-label>
                <nz-form-control nzHasFeedback nzErrorTip="Please Enter Option">
                  <textarea
                    rows="1"
                    nz-input
                    placeholder="Enter Option"
                    name="options"
                    maxlength="256"
                    required
                    [(ngModel)]="OPTION_TEXT"
                  ></textarea>
                  <h6 style="color: red; font-size: 10px" *ngIf="OPTION_TEXT">
                    {{ OPTION_TEXT.length }}/256
                  </h6>
                  <h6 style="color: red; font-size: 10px" *ngIf="!OPTION_TEXT">
                    0/256
                  </h6>
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="7">
              <nz-form-item>
                <nz-form-label nzNoColon>Option Image</nz-form-label>
                <div style="text-align: left">
                  <div
                    *ngIf="
                      OPTION_IMAGE_URL == null ||
                      OPTION_IMAGE_URL == undefined ||
                      OPTION_IMAGE_URL == ''
                    "
                    style="color: blue"
                  >
                    <button
                      nz-button
                      style="
                        height: 28px;
                        padding: 0px 7px;
                        font-size: 12px;
                        width: 100%;
                      "
                      (click)="fileInput.click()"
                    >
                      <span nz-icon nzType="upload" nzTheme="outline"></span>
                      <input
                        #fileInput
                        name="answerImage"
                        accept=".jpg, .jpeg, .png"
                        (change)="onFileSelectedOption($event)"
                        type="file"
                        style="display: none"
                      />
                    </button>
                  </div>
                  <span
                    *ngIf="
                      OPTION_IMAGE_URL !== null &&
                      OPTION_IMAGE_URL !== undefined &&
                      OPTION_IMAGE_URL !== ''
                    "
                  >
                    <div *ngIf="progressBarOptionImage">
                      <nz-progress
                        [style.width]="percentOptionImage + '%'"
                        [nzPercent]="percentOptionImage"
                        >{{ percentOptionImage }}%</nz-progress
                      >
                    </div>
                    {{ OPTION_IMAGE_URL }}
                  </span>
                  <br />

                  <div
                    *ngIf="
                      OPTION_IMAGE_URL !== null &&
                      OPTION_IMAGE_URL !== undefined &&
                      OPTION_IMAGE_URL !== ''
                    "
                    style="display: flex; justify-content: center"
                  >
                    <a
                      style="color: blue; margin-right: 9px"
                      (click)="ViewOption(OPTION_IMAGE_URL)"
                      nz-tooltip
                      nzTooltipTitle="Click Here To View Uploaded Document"
                    >
                      <span nz-icon nzType="eye" nzTheme="outline"></span>
                    </a>

                    <span
                      style="cursor: pointer"
                      nz-popconfirm
                      nzPopconfirmTitle="Are you sure want delete?"
                      (nzOnConfirm)="deleteOptionConfirm(OPTION_IMAGE_URL)"
                      (nzOnCancel)="deleteCancel()"
                      nzPopconfirmPlacement="top"
                    >
                      <span
                        nz-icon
                        nzType="delete"
                        nzTheme="twotone"
                        nz-tooltip
                        nzTooltipTitle="Delete"
                      >
                      </span>
                    </span>
                  </div>
                </div>
              </nz-form-item>
            </div>

            <div nz-col nzSpan="1"></div>
            <div nz-col nzSpan="2">
              <!-- <nz-form-item> -->
              <nz-form-item>
                <nz-form-label nzNoColon> </nz-form-label>
                <nz-form-control nzHasFeedback nzErrorTip="Enter Marks">
                  <button
                    style="width: 100%"
                    nz-button
                    nzType="primary"
                    (click)="addOptions()"
                  >
                    <i nz-icon nzType="plus"></i>
                  </button>
                </nz-form-control>
              </nz-form-item>

              <!-- </nz-form-item> -->
            </div>

            <div nz-col nzSpan="24" *ngIf="OptionList.length > 0">
              <nz-table
                style="
                  width: 100% !important;
                  max-height: 300px;
                  overflow: auto;
                "
                nzBordered
                #table
                [nzFrontPagination]="false"
                [nzData]="OptionList"
                [nzLoading]="loadingOptions"
                [nzSize]="'small'"
              >
                <thead>
                  <tr>
                    <th style="width: 10%">Action</th>
                    <th style="width: 40%">Option</th>
                    <th style="width: 15%">Is Correct</th>
                    <th style="width: 15%">Sequence No</th>
                    <th style="width: 10%">Image</th>
                    <th style="width: 10%">Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let data of table.data; index as i">
                    <td>
                      <a (click)="editRow(data, i)">
                        <i nz-icon nzType="edit" nzTheme="outline"></i
                      ></a>
                    </td>
                    <td>
                      {{ data.OPTION_TEXT }}
                    </td>
                    <td>
                      <label
                        nz-checkbox
                        [ngModelOptions]="{ standalone: true }"
                        name="iscorrect"
                        [(ngModel)]="data.IS_CORRECT"
                        (ngModelChange)="correctOption($event, i)"
                      >
                      </label>
                    </td>
                    <td>
                      <nz-input-number
                        [ngModelOptions]="{ standalone: true }"
                        [nzMin]="0"
                        name="SequenceNo"
                        [(ngModel)]="OptionList[i].SEQ_NO"
                      >
                      </nz-input-number>
                    </td>
                    <td>
                      <span
                        *ngIf="
                          data.OPTION_IMAGE_URL != null &&
                          data.OPTION_IMAGE_URL != ''
                        "
                      >
                        <img
                          src="{{ api.retriveimgUrl }}optionImage/{{
                            data.OPTION_IMAGE_URL
                          }}"
                          style="width: 50px; height: 50px"
                        />
                      </span>
                      <span
                        *ngIf="
                          data.OPTION_IMAGE_URL == null ||
                          data.OPTION_IMAGE_URL == ''
                        "
                      >
                      </span>
                    </td>
                    <td>
                      <nz-switch
                        name="questatus{{ i }}"
                        [(ngModel)]="OptionList[i].STATUS"
                        nzCheckedChildren="Yes"
                        nzUnCheckedChildren="No"
                      ></nz-switch>
                    </td>
                  </tr>
                </tbody>
              </nz-table>
            </div>
          </div>
        </div>
      </div>
    </nz-spin>
  </form>

  <div class="footer">
    <button
      type="button"
      nz-button
      (click)="close()"
      class="ant-btn"
      style="margin-right: 8px"
    >
      <span>Cancel</span>
    </button>
    <button
      type="button"
      class="ant-btn ant-btn-primary"
      *ngIf="!data.ID"
      nz-button
      nz-dropdown
      [nzDropdownMenu]="menu"
      (click)="save(false, Employee)"
    >
      <span>Save & Close</span>
    </button>
    <nz-dropdown-menu #menu="nzDropdownMenu">
      <ul nz-menu>
        <li
          nz-menu-item
          class="menuc"
          style="border-radius: 4px; background-color: #40a9ff"
        >
          <a style="color: white" (click)="save(true, Student)">Save & New</a>
        </li>
      </ul>
    </nz-dropdown-menu>
    <button
      type="button"
      class="ant-btn ant-btn-primary"
      nz-button
      [nzLoading]="isSpinning"
      *ngIf="data.ID"
      (click)="save(false, Employee)"
    >
      <span>Update & close</span>
    </button>
  </div>
</div>

<nz-modal
  [nzWidth]="900"
  [(nzVisible)]="printOrderModalVisible"
  nzMaskClosable="false"
  nzClosable="false"
  [nzContent]="printOrderModalContent1"
  [nzTitle]="'Preview'"
  (nzOnCancel)="ViewModalCancel()"
  [nzFooter]="printOrderModalFooter1"
>
  <ng-template #printOrderModalContent1>
    <nz-spin [nzSpinning]="isSpinning">
      <div
        *ngIf="imageshow != undefined && imageshow != null && imageshow != ''"
        class="ss"
        style="height: 600px; overflow: auto"
      >
        <iframe
          [src]="imageshow"
          style="width: 832px; height: 596px"
          frameborder="0"
        ></iframe>
      </div>
    </nz-spin>
  </ng-template>
  <ng-template #printOrderModalFooter1>
    <button nz-button nzType="default" (click)="ViewModalCancel()">
      Close
    </button>
  </ng-template>
</nz-modal>
